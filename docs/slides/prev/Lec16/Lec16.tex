\PassOptionsToPackage{unicode=true}{hyperref} % options for packages loaded elsewhere
\PassOptionsToPackage{hyphens}{url}
%
\documentclass[11pt,ignorenonframetext,]{beamer}
\usepackage{pgfpages}
\setbeamertemplate{caption}[numbered]
\setbeamertemplate{caption label separator}{: }
\setbeamercolor{caption name}{fg=normal text.fg}
\beamertemplatenavigationsymbolsempty
% Prevent slide breaks in the middle of a paragraph:
\widowpenalties 1 10000
\raggedbottom
\setbeamertemplate{part page}{
\centering
\begin{beamercolorbox}[sep=16pt,center]{part title}
  \usebeamerfont{part title}\insertpart\par
\end{beamercolorbox}
}
\setbeamertemplate{section page}{
\centering
\begin{beamercolorbox}[sep=12pt,center]{part title}
  \usebeamerfont{section title}\insertsection\par
\end{beamercolorbox}
}
\setbeamertemplate{subsection page}{
\centering
\begin{beamercolorbox}[sep=8pt,center]{part title}
  \usebeamerfont{subsection title}\insertsubsection\par
\end{beamercolorbox}
}
\AtBeginPart{
  \frame{\partpage}
}
\AtBeginSection{
  \ifbibliography
  \else
    \frame{\sectionpage}
  \fi
}
\AtBeginSubsection{
  \frame{\subsectionpage}
}
\usepackage{lmodern}
\usepackage{amssymb,amsmath}
\usepackage{ifxetex,ifluatex}
\usepackage{fixltx2e} % provides \textsubscript
\ifnum 0\ifxetex 1\fi\ifluatex 1\fi=0 % if pdftex
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
  \usepackage{textcomp} % provides euro and other symbols
\else % if luatex or xelatex
  \usepackage{unicode-math}
  \defaultfontfeatures{Ligatures=TeX,Scale=MatchLowercase}
\fi
\usetheme[]{metropolis}
% use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
% use microtype if available
\IfFileExists{microtype.sty}{%
\usepackage[]{microtype}
\UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\IfFileExists{parskip.sty}{%
\usepackage{parskip}
}{% else
\setlength{\parindent}{0pt}
\setlength{\parskip}{6pt plus 2pt minus 1pt}
}
\usepackage{hyperref}
\hypersetup{
            pdftitle={Lecture 16},
            pdfborder={0 0 0},
            breaklinks=true}
\urlstyle{same}  % don't use monospace font for urls
\newif\ifbibliography
\usepackage{color}
\usepackage{fancyvrb}
\newcommand{\VerbBar}{|}
\newcommand{\VERB}{\Verb[commandchars=\\\{\}]}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
% Add ',fontsize=\small' for more characters per line
\newenvironment{Shaded}{}{}
\newcommand{\AlertTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{#1}}}
\newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{#1}}}}
\newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.49,0.56,0.16}{#1}}
\newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{#1}}
\newcommand{\BuiltInTok}[1]{#1}
\newcommand{\CharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{#1}}
\newcommand{\CommentTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textit{#1}}}
\newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{#1}}}}
\newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.53,0.00,0.00}{#1}}
\newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{#1}}}
\newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.56,0.13,0.00}{#1}}
\newcommand{\DecValTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{#1}}
\newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.73,0.13,0.13}{\textit{#1}}}
\newcommand{\ErrorTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{#1}}}
\newcommand{\ExtensionTok}[1]{#1}
\newcommand{\FloatTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{#1}}
\newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.02,0.16,0.49}{#1}}
\newcommand{\ImportTok}[1]{#1}
\newcommand{\InformationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{#1}}}}
\newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{#1}}}
\newcommand{\NormalTok}[1]{#1}
\newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.40,0.40,0.40}{#1}}
\newcommand{\OtherTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{#1}}
\newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.74,0.48,0.00}{#1}}
\newcommand{\RegionMarkerTok}[1]{#1}
\newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{#1}}
\newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.73,0.40,0.53}{#1}}
\newcommand{\StringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{#1}}
\newcommand{\VariableTok}[1]{\textcolor[rgb]{0.10,0.09,0.49}{#1}}
\newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{#1}}
\newcommand{\WarningTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{#1}}}}
\setlength{\emergencystretch}{3em}  % prevent overfull lines
\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
\setcounter{secnumdepth}{0}

% set default figure placement to htbp
\makeatletter
\def\fps@figure{htbp}
\makeatother

\usepackage{geometry}
\usepackage{graphicx}

\usepackage{bbold}
\usepackage{lmodern}


\usepackage{url}		% produces hyperlinks

\usepackage{colortbl}	% allows for color usage in tables
\usepackage{multirow}	% allows for rows that span multiple rows in tables

\usepackage{color}          	% gives color options
\usepackage{xcolor}		% this package has a variety of color options

\usepackage{multicol}
\usepackage{textcomp}

\usepackage{setspace}
\usepackage{changepage}
\usepackage{isotope}

\singlespacing

\def\begincol{\begin{column}}
\def\endcol{\end{column}}

\def\begincols{\begin{columns}}
\def\endcols{\end{columns}}

%%%%%%%%%%%%%%%%
% Small code output
%%%%%%%%%%%%%%%%

%% change fontsize of R code

\makeatletter
\@ifundefined{Shaded}{\newenvironment{Shaded}{}{}}{}
\makeatother


\let\oldShaded\Shaded
\let\endoldShaded\endShaded
\renewenvironment{Shaded}{\footnotesize\begin{spacing}{0.9}\oldShaded}{\endoldShaded\end{spacing}}

%% change fontsize of output
\let\oldverbatim\verbatim
\let\endoldverbatim\endverbatim
\renewenvironment{verbatim}{\footnotesize\begin{spacing}{0.9}\oldverbatim}{\endoldverbatim\end{spacing}}


\newcommand{\tinyoutput}{
  \renewenvironment{Shaded}{\tiny\begin{spacing}{0.9}\oldShaded}{\endoldShaded\end{spacing}}
  \renewenvironment{verbatim}{\tiny\begin{spacing}{0.9}\oldverbatim}{\endoldverbatim\end{spacing}}
}

\newcommand{\scriptoutput}{
  \renewenvironment{Shaded}{\scriptsize\begin{spacing}{0.9}\oldShaded}{\endoldShaded\end{spacing}}
  \renewenvironment{verbatim}{\scriptsize\begin{spacing}{0.9}\oldverbatim}{\endoldverbatim\end{spacing}}
}

\newcommand{\footnoteoutput}{
  \renewenvironment{Shaded}{\footnotesize\begin{spacing}{0.9}\oldShaded}{\endoldShaded\end{spacing}}
  \renewenvironment{verbatim}{\footnotesize\begin{spacing}{0.9}\oldverbatim}{\endoldverbatim\end{spacing}}
}

%\newcommand{\verbatimfont}[1]{\renewcommand{\verbatim@font}{\ttfamily#1}}


%%%%%%%%%%%%%%%%
% Custom Colors
%%%%%%%%%%%%%%%%

\definecolor{redhl}{rgb}{0.98,0.29,0.28}
\definecolor{yellowhl}{rgb}{0.98,0.87,0.28}


\xdefinecolor{oiBlue}{rgb}{0.15, 0.35, 0.55}
\xdefinecolor{gray}{rgb}{0.5, 0.5, 0.5}
\xdefinecolor{darkGray}{rgb}{0.3, 0.3, 0.3}
\xdefinecolor{darkerGray}{rgb}{0.2, 0.2, 0.2}
\xdefinecolor{rubineRed}{rgb}{0.89,0,0.30}
\xdefinecolor{linkCol}{rgb}{0.11,0.49,0.95}	
\xdefinecolor{irishGreen}{rgb}{0,0.60,0}	
\xdefinecolor{darkturquoise}{rgb}{0.44, 0.58, 0.86}
\definecolor{lightGreen}{rgb}{0.533,0.765,0.42}
%\xdefinecolor{hlblue}{rgb}{0.051,0.65,1}
\xdefinecolor{hlblue}{rgb}{ 0.055, 0.639, 0.831}
\definecolor{light}{rgb}{.337,.608,.741}
\definecolor{dark}{rgb}{.337,.608,.741}

\definecolor{cpink}{rgb}{0.93, 0.23, 0.51}

%%%%%%%%%%%%%%%%
% Custom Commands
%%%%%%%%%%%%%%%%

% text colors
\newcommand{\red}[1]{\textit{\textcolor{rubineRed}{#1}}}
\newcommand{\orange}[1]{\textit{\textcolor{orange}{#1}}}
\newcommand{\pink}[1]{\textit{\textcolor{rubineRed!90!white!50}{#1}}}
\newcommand{\green}[1]{\textit{\textcolor{irishGreen}{#1}}}
\newcommand{\blue}[1]{\textit{\textcolor{darkturquoise}{#1}}}
\newcommand{\light}[1]{\textcolor{light}{\textbf{#1}}}
\newcommand{\dark}[1]{\textcolor{dark}{#1}}
\newcommand{\gray}[1]{\textcolor{gray}{#1}}


% mail
\newcommand{\mail}[1]{\href{mailto:#1}{\textit{\textcolor{linkCol}{#1}}}}

% highlighting: hl, hlGr, mathhl
\newcommand{\hl}[1]{\textit{\textcolor{hlblue}{#1}}}
\newcommand{\hlGr}[1]{\textit{\textcolor{lightGreen}{#1}}}
\newcommand{\hlRd}[1]{\textit{\textcolor{rubineRed}{#1}}}
\newcommand{\mathhl}[1]{\textcolor{hlblue}{\ensuremath{#1}}}
\newcommand{\hlr}[1]{\fcolorbox{redhl}{white}{$\displaystyle #1$}}
\newcommand{\hly}[1]{\fcolorbox{yellowhl}{white}{$\displaystyle #1$}}


\newcommand{\vvfill}{\vskip0pt plus 1filll}

\DeclareMathOperator*{\argmin}{arg\,min}
\DeclareMathOperator*{\argmax}{arg\,max}

\title{Lecture 16}
\providecommand{\subtitle}[1]{}
\subtitle{Spatial Data and Cartography (Part 2)}
\date{10/31/2018}

\begin{document}
\frame{\titlepage}

\hypertarget{plotting}{%
\section{Plotting}\label{plotting}}

\begin{frame}[fragile,t]{Example Data - NC SIDS}
\protect\hypertarget{example-data---nc-sids}{}

\scriptoutput

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{nc =}\StringTok{ }\KeywordTok{st_read}\NormalTok{(}\KeywordTok{system.file}\NormalTok{(}\StringTok{"shape/nc.shp"}\NormalTok{, }\DataTypeTok{package=}\StringTok{"sf"}\NormalTok{), }\DataTypeTok{quiet =} \OtherTok{TRUE}\NormalTok{) }\OperatorTok{%>%}\StringTok{ }
\StringTok{  }\KeywordTok{select}\NormalTok{(}\OperatorTok{-}\NormalTok{(AREA}\OperatorTok{:}\NormalTok{CNTY_ID), }\OperatorTok{-}\NormalTok{(FIPS}\OperatorTok{:}\NormalTok{CRESS_ID))}

\KeywordTok{tbl_df}\NormalTok{(nc)}
\CommentTok{## # A tibble: 100 x 8}
\CommentTok{##    NAME  BIR74 SID74 NWBIR74 BIR79 SID79 NWBIR79                  geometry}
\CommentTok{##    <fct> <dbl> <dbl>   <dbl> <dbl> <dbl>   <dbl>        <MULTIPOLYGON [Â°]>}
\CommentTok{##  1 Ashe   1091     1      10  1364     0      19 (((-81.47276 36.23436, -~}
\CommentTok{##  2 Alle~   487     0      10   542     3      12 (((-81.23989 36.36536, -~}
\CommentTok{##  3 Surry  3188     5     208  3616     6     260 (((-80.45634 36.24256, -~}
\CommentTok{##  4 Curr~   508     1     123   830     2     145 (((-76.00897 36.3196, -7~}
\CommentTok{##  5 Nort~  1421     9    1066  1606     3    1197 (((-77.21767 36.24098, -~}
\CommentTok{##  6 Hert~  1452     7     954  1838     5    1237 (((-76.74506 36.23392, -~}
\CommentTok{##  7 Camd~   286     0     115   350     2     139 (((-76.00897 36.3196, -7~}
\CommentTok{##  8 Gates   420     0     254   594     2     371 (((-76.56251 36.34057, -~}
\CommentTok{##  9 Warr~   968     4     748  1190     2     844 (((-78.30876 36.26004, -~}
\CommentTok{## 10 Stok~  1612     1     160  2038     5     176 (((-80.02567 36.25023, -~}
\CommentTok{## # ... with 90 more rows}
\end{Highlighting}
\end{Shaded}

\end{frame}

\begin{frame}[fragile,t]{Base Plots}
\protect\hypertarget{base-plots}{}

\scriptoutput

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{plot}\NormalTok{(nc)}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=0.8\textwidth]{Lec16_files/figure-beamer/unnamed-chunk-2-1} \end{center}

\end{frame}

\begin{frame}[fragile,t]{Geometry Plot}
\protect\hypertarget{geometry-plot}{}

\scriptoutput

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{plot}\NormalTok{(}\KeywordTok{st_geometry}\NormalTok{(nc), }\DataTypeTok{axes=}\OtherTok{TRUE}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=\textwidth]{Lec16_files/figure-beamer/unnamed-chunk-3-1} \end{center}

\end{frame}

\begin{frame}[fragile,t]{Graticules}
\protect\hypertarget{graticules}{}

\scriptoutput

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{plot}\NormalTok{(nc[,}\StringTok{"SID79"}\NormalTok{], }\DataTypeTok{axes=}\OtherTok{TRUE}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=\textwidth]{Lec16_files/figure-beamer/unnamed-chunk-4-1} \end{center}

\end{frame}

\begin{frame}[fragile,t]{Graticules}
\protect\hypertarget{graticules-1}{}

\scriptoutput

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{plot}\NormalTok{(nc[,}\StringTok{"SID79"}\NormalTok{], }\DataTypeTok{graticule=}\KeywordTok{st_crs}\NormalTok{(nc), }\DataTypeTok{axes=}\OtherTok{TRUE}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=\textwidth]{Lec16_files/figure-beamer/unnamed-chunk-5-1} \end{center}

\end{frame}

\begin{frame}[fragile,t]{Graticules (EPSG:3631)}
\protect\hypertarget{graticules-epsg3631}{}

\scriptoutput

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{plot}\NormalTok{(}\KeywordTok{st_transform}\NormalTok{(nc[,}\StringTok{"SID79"}\NormalTok{], }\DecValTok{3631}\NormalTok{), }\DataTypeTok{axes=}\OtherTok{TRUE}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=\textwidth]{Lec16_files/figure-beamer/unnamed-chunk-6-1} \end{center}

\end{frame}

\begin{frame}[fragile,t]{Graticules (EPSG:3631)}
\protect\hypertarget{graticules-epsg3631-1}{}

\scriptoutput

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{plot}\NormalTok{(}\KeywordTok{st_transform}\NormalTok{(nc[,}\StringTok{"SID79"}\NormalTok{], }\DecValTok{3631}\NormalTok{), }\DataTypeTok{graticule=}\KeywordTok{st_crs}\NormalTok{(nc), }\DataTypeTok{axes=}\OtherTok{TRUE}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=\textwidth]{Lec16_files/figure-beamer/unnamed-chunk-7-1} \end{center}

\end{frame}

\begin{frame}[fragile,t]{Graticules (EPSG:3631)}
\protect\hypertarget{graticules-epsg3631-2}{}

\scriptoutput

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{plot}\NormalTok{(}\KeywordTok{st_transform}\NormalTok{(nc[,}\StringTok{"SID79"}\NormalTok{], }\DecValTok{3631}\NormalTok{), }\DataTypeTok{graticule=}\KeywordTok{st_crs}\NormalTok{(}\DecValTok{3631}\NormalTok{), }\DataTypeTok{axes=}\OtherTok{TRUE}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=\textwidth]{Lec16_files/figure-beamer/unnamed-chunk-8-1} \end{center}

\end{frame}

\begin{frame}[fragile,t]{ggplot2}
\protect\hypertarget{ggplot2}{}

\scriptoutput

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{ggplot}\NormalTok{(nc) }\OperatorTok{+}\StringTok{ }
\StringTok{  }\KeywordTok{geom_sf}\NormalTok{(}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{fill=}\NormalTok{SID79))}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=\textwidth]{Lec16_files/figure-beamer/unnamed-chunk-9-1} \end{center}

\end{frame}

\begin{frame}[fragile,t]{ggplot2 + projections}
\protect\hypertarget{ggplot2-projections}{}

\scriptoutput

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{ggplot}\NormalTok{(}\KeywordTok{st_transform}\NormalTok{(nc, }\DecValTok{3631}\NormalTok{)) }\OperatorTok{+}\StringTok{ }
\StringTok{  }\KeywordTok{geom_sf}\NormalTok{(}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{fill=}\NormalTok{SID79 }\OperatorTok{/}\StringTok{ }\NormalTok{BIR79))}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=\textwidth]{Lec16_files/figure-beamer/unnamed-chunk-10-1} \end{center}

\end{frame}

\begin{frame}[fragile,t]{ggplot2 + viridis}
\protect\hypertarget{ggplot2-viridis}{}

\scriptoutput

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{ggplot}\NormalTok{(}\KeywordTok{st_transform}\NormalTok{(nc, }\DecValTok{3631}\NormalTok{)) }\OperatorTok{+}\StringTok{ }
\StringTok{  }\KeywordTok{geom_sf}\NormalTok{(}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{fill=}\NormalTok{SID79 }\OperatorTok{/}\StringTok{ }\NormalTok{BIR79)) }\OperatorTok{+}
\StringTok{  }\KeywordTok{scale_fill_viridis_c}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=\textwidth]{Lec16_files/figure-beamer/unnamed-chunk-11-1} \end{center}

\end{frame}

\begin{frame}[fragile]{Example Data - Meuse}
\protect\hypertarget{example-data---meuse}{}

\scriptoutput

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{data}\NormalTok{(meuse, meuse.riv, }\DataTypeTok{package=}\StringTok{"sp"}\NormalTok{)}

\NormalTok{meuse =}\StringTok{ }\KeywordTok{st_as_sf}\NormalTok{(meuse, }\DataTypeTok{coords=}\KeywordTok{c}\NormalTok{(}\StringTok{"x"}\NormalTok{, }\StringTok{"y"}\NormalTok{), }\DataTypeTok{crs=}\DecValTok{28992}\NormalTok{)}
\NormalTok{meuse_riv =}\StringTok{ }\KeywordTok{st_polygon}\NormalTok{(}\KeywordTok{list}\NormalTok{(meuse.riv)) }\OperatorTok{%>%}\StringTok{ }\KeywordTok{st_sfc}\NormalTok{() }\OperatorTok{%>%}\StringTok{ }\KeywordTok{st_set_crs}\NormalTok{(}\DecValTok{28992}\NormalTok{)}

\KeywordTok{tbl_df}\NormalTok{(meuse)}
\CommentTok{## # A tibble: 155 x 13}
\CommentTok{##    cadmium copper  lead  zinc  elev    dist    om ffreq soil  lime  landuse}
\CommentTok{##  *   <dbl>  <dbl> <dbl> <dbl> <dbl>   <dbl> <dbl> <fct> <fct> <fct> <fct>  }
\CommentTok{##  1    11.7     85   299  1022  7.91 0.00136  13.6 1     1     1     Ah     }
\CommentTok{##  2     8.6     81   277  1141  6.98 0.0122   14   1     1     1     Ah     }
\CommentTok{##  3     6.5     68   199   640  7.8  0.103    13   1     1     1     Ah     }
\CommentTok{##  4     2.6     81   116   257  7.66 0.190     8   1     2     0     Ga     }
\CommentTok{##  5     2.8     48   117   269  7.48 0.277     8.7 1     2     0     Ah     }
\CommentTok{##  6     3       61   137   281  7.79 0.364     7.8 1     2     0     Ga     }
\CommentTok{##  7     3.2     31   132   346  8.22 0.190     9.2 1     2     0     Ah     }
\CommentTok{##  8     2.8     29   150   406  8.49 0.0922    9.5 1     1     0     Ab     }
\CommentTok{##  9     2.4     37   133   347  8.67 0.185    10.6 1     1     0     Ab     }
\CommentTok{## 10     1.6     24    80   183  9.05 0.310     6.3 1     2     0     W      }
\CommentTok{## # ... with 145 more rows, and 2 more variables: dist.m <dbl>,}
\CommentTok{## #   geometry <POINT [m]>}
\end{Highlighting}
\end{Shaded}

\end{frame}

\begin{frame}[fragile,t]{Meuse}
\protect\hypertarget{meuse}{}

\scriptoutput

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{plot}\NormalTok{(meuse, }\DataTypeTok{pch=}\DecValTok{16}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=\textwidth]{Lec16_files/figure-beamer/unnamed-chunk-13-1} \end{center}

\end{frame}

\begin{frame}[fragile,t]{Layering plots}
\protect\hypertarget{layering-plots}{}

\scriptoutput

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{plot}\NormalTok{(meuse_riv, }\DataTypeTok{col=}\KeywordTok{adjustcolor}\NormalTok{(}\StringTok{"lightblue"}\NormalTok{, }\DataTypeTok{alpha.f=}\DecValTok{1}\NormalTok{), }\DataTypeTok{border =} \OtherTok{NA}\NormalTok{, }
     \DataTypeTok{axes=}\OtherTok{TRUE}\NormalTok{, }\DataTypeTok{graticule=}\KeywordTok{st_crs}\NormalTok{(}\DecValTok{4326}\NormalTok{), }\DataTypeTok{xlim=}\KeywordTok{st_bbox}\NormalTok{(meuse)[}\KeywordTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{,}\DecValTok{3}\NormalTok{)], }\DataTypeTok{ylim=}\KeywordTok{st_bbox}\NormalTok{(meuse)[}\KeywordTok{c}\NormalTok{(}\DecValTok{2}\NormalTok{,}\DecValTok{4}\NormalTok{)])}
\KeywordTok{plot}\NormalTok{(meuse[,}\StringTok{"lead"}\NormalTok{], }\DataTypeTok{pch=}\DecValTok{16}\NormalTok{, }\DataTypeTok{add=}\OtherTok{TRUE}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=\textwidth]{Lec16_files/figure-beamer/unnamed-chunk-14-1} \end{center}

\end{frame}

\begin{frame}[fragile,t]{ggplot2}
\protect\hypertarget{ggplot2-1}{}

\scriptoutput

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{ggplot}\NormalTok{() }\OperatorTok{+}
\StringTok{  }\KeywordTok{geom_sf}\NormalTok{(}\DataTypeTok{data=}\KeywordTok{st_sf}\NormalTok{(meuse_riv), }\DataTypeTok{fill=}\StringTok{"lightblue"}\NormalTok{, }\DataTypeTok{color=}\OtherTok{NA}\NormalTok{) }\OperatorTok{+}
\StringTok{  }\KeywordTok{geom_sf}\NormalTok{(}\DataTypeTok{data=}\NormalTok{meuse, }\KeywordTok{aes}\NormalTok{(}\DataTypeTok{color=}\NormalTok{lead), }\DataTypeTok{size=}\DecValTok{1}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=0.33\textwidth]{Lec16_files/figure-beamer/unnamed-chunk-15-1} \end{center}

\end{frame}

\begin{frame}[fragile,t]{ggplot2 - axis limits}
\protect\hypertarget{ggplot2---axis-limits}{}

\scriptoutput

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{ggplot}\NormalTok{() }\OperatorTok{+}
\StringTok{  }\KeywordTok{geom_sf}\NormalTok{(}\DataTypeTok{data=}\KeywordTok{st_sf}\NormalTok{(meuse_riv), }\DataTypeTok{fill=}\StringTok{"lightblue"}\NormalTok{, }\DataTypeTok{color=}\OtherTok{NA}\NormalTok{) }\OperatorTok{+}
\StringTok{  }\KeywordTok{geom_sf}\NormalTok{(}\DataTypeTok{data=}\NormalTok{meuse, }\KeywordTok{aes}\NormalTok{(}\DataTypeTok{color=}\NormalTok{lead), }\DataTypeTok{size=}\DecValTok{1}\NormalTok{) }\OperatorTok{+}
\StringTok{  }\KeywordTok{ylim}\NormalTok{(}\FloatTok{50.95}\NormalTok{, }\FloatTok{50.99}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=0.65\textwidth]{Lec16_files/figure-beamer/unnamed-chunk-16-1} \end{center}

\end{frame}

\begin{frame}[fragile,t]{ggplot2 - axis limits}
\protect\hypertarget{ggplot2---axis-limits-1}{}

\scriptoutput

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{ggplot}\NormalTok{() }\OperatorTok{+}
\StringTok{  }\KeywordTok{geom_sf}\NormalTok{(}\DataTypeTok{data=}\KeywordTok{st_sf}\NormalTok{(meuse_riv), }\DataTypeTok{fill=}\StringTok{"lightblue"}\NormalTok{, }\DataTypeTok{color=}\OtherTok{NA}\NormalTok{) }\OperatorTok{+}
\StringTok{  }\KeywordTok{geom_sf}\NormalTok{(}\DataTypeTok{data=}\NormalTok{meuse, }\KeywordTok{aes}\NormalTok{(}\DataTypeTok{color=}\NormalTok{lead), }\DataTypeTok{size=}\DecValTok{1}\NormalTok{) }\OperatorTok{+}
\StringTok{  }\KeywordTok{ylim}\NormalTok{(}\DecValTok{329714}\NormalTok{, }\DecValTok{333611}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=0.65\textwidth]{Lec16_files/figure-beamer/unnamed-chunk-17-1} \end{center}

\end{frame}

\begin{frame}[fragile,t]{ggplot2 - bounding box}
\protect\hypertarget{ggplot2---bounding-box}{}

\scriptoutput

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{ggplot}\NormalTok{() }\OperatorTok{+}
\StringTok{  }\KeywordTok{geom_sf}\NormalTok{(}\DataTypeTok{data=}\KeywordTok{st_sf}\NormalTok{(meuse_riv), }\DataTypeTok{fill=}\StringTok{"lightblue"}\NormalTok{, }\DataTypeTok{color=}\OtherTok{NA}\NormalTok{) }\OperatorTok{+}
\StringTok{  }\KeywordTok{geom_sf}\NormalTok{(}\DataTypeTok{data=}\NormalTok{meuse, }\KeywordTok{aes}\NormalTok{(}\DataTypeTok{color=}\NormalTok{lead), }\DataTypeTok{size=}\DecValTok{1}\NormalTok{) }\OperatorTok{+}
\StringTok{  }\KeywordTok{ylim}\NormalTok{(}\KeywordTok{st_bbox}\NormalTok{(meuse)[}\StringTok{"ymin"}\NormalTok{], }\KeywordTok{st_bbox}\NormalTok{(meuse)[}\StringTok{"ymax"}\NormalTok{])}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=0.65\textwidth]{Lec16_files/figure-beamer/unnamed-chunk-18-1} \end{center}

\end{frame}

\hypertarget{geometry-manipulation}{%
\section{Geometry Manipulation}\label{geometry-manipulation}}

\begin{frame}[fragile,t]{Casting}
\protect\hypertarget{casting}{}

\scriptoutput

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{nc_pts =}\StringTok{ }\KeywordTok{st_cast}\NormalTok{(nc, }\StringTok{"MULTIPOINT"}\NormalTok{)}

\KeywordTok{tbl_df}\NormalTok{(nc_pts)}
\CommentTok{## # A tibble: 100 x 8}
\CommentTok{##    NAME  BIR74 SID74 NWBIR74 BIR79 SID79 NWBIR79                  geometry}
\CommentTok{##  * <fct> <dbl> <dbl>   <dbl> <dbl> <dbl>   <dbl>          <MULTIPOINT [Â°]>}
\CommentTok{##  1 Ashe   1091     1      10  1364     0      19 (-81.47276 36.23436, -81~}
\CommentTok{##  2 Alle~   487     0      10   542     3      12 (-81.23989 36.36536, -81~}
\CommentTok{##  3 Surry  3188     5     208  3616     6     260 (-80.45634 36.24256, -80~}
\CommentTok{##  4 Curr~   508     1     123   830     2     145 (-76.00897 36.3196, -76.~}
\CommentTok{##  5 Nort~  1421     9    1066  1606     3    1197 (-77.21767 36.24098, -77~}
\CommentTok{##  6 Hert~  1452     7     954  1838     5    1237 (-76.74506 36.23392, -76~}
\CommentTok{##  7 Camd~   286     0     115   350     2     139 (-76.00897 36.3196, -75.~}
\CommentTok{##  8 Gates   420     0     254   594     2     371 (-76.56251 36.34057, -76~}
\CommentTok{##  9 Warr~   968     4     748  1190     2     844 (-78.30876 36.26004, -78~}
\CommentTok{## 10 Stok~  1612     1     160  2038     5     176 (-80.02567 36.25023, -80~}
\CommentTok{## # ... with 90 more rows}
\end{Highlighting}
\end{Shaded}

\end{frame}

\begin{frame}[fragile,t]{}
\protect\hypertarget{section}{}

\scriptoutput

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{plot}\NormalTok{(}\KeywordTok{st_geometry}\NormalTok{(nc), }\DataTypeTok{border=}\StringTok{'grey'}\NormalTok{)}
\KeywordTok{plot}\NormalTok{(}\KeywordTok{st_geometry}\NormalTok{(nc_pts), }\DataTypeTok{pch=}\DecValTok{16}\NormalTok{, }\DataTypeTok{cex=}\FloatTok{0.5}\NormalTok{, }\DataTypeTok{add=}\OtherTok{TRUE}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=\textwidth]{Lec16_files/figure-beamer/unnamed-chunk-20-1} \end{center}

\end{frame}

\begin{frame}[fragile,t]{Casting - POINT}
\protect\hypertarget{casting---point}{}

\scriptoutput

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{st_cast}\NormalTok{(nc, }\StringTok{"POINT"}\NormalTok{)}
\CommentTok{## Simple feature collection with 2529 features and 7 fields}
\CommentTok{## geometry type:  POINT}
\CommentTok{## dimension:      XY}
\CommentTok{## bbox:           xmin: -84.32385 ymin: 33.88199 xmax: -75.45698 ymax: 36.58965}
\CommentTok{## epsg (SRID):    4267}
\CommentTok{## proj4string:    +proj=longlat +datum=NAD27 +no_defs}
\CommentTok{## First 10 features:}
\CommentTok{##     NAME BIR74 SID74 NWBIR74 BIR79 SID79 NWBIR79}
\CommentTok{## 1   Ashe  1091     1      10  1364     0      19}
\CommentTok{## 1.1 Ashe  1091     1      10  1364     0      19}
\CommentTok{## 1.2 Ashe  1091     1      10  1364     0      19}
\CommentTok{## 1.3 Ashe  1091     1      10  1364     0      19}
\CommentTok{## 1.4 Ashe  1091     1      10  1364     0      19}
\CommentTok{## 1.5 Ashe  1091     1      10  1364     0      19}
\CommentTok{## 1.6 Ashe  1091     1      10  1364     0      19}
\CommentTok{## 1.7 Ashe  1091     1      10  1364     0      19}
\CommentTok{## 1.8 Ashe  1091     1      10  1364     0      19}
\CommentTok{## 1.9 Ashe  1091     1      10  1364     0      19}
\CommentTok{##                       geometry}
\CommentTok{## 1   POINT (-81.47276 36.23436)}
\CommentTok{## 1.1 POINT (-81.54084 36.27251)}
\CommentTok{## 1.2 POINT (-81.56198 36.27359)}
\CommentTok{## 1.3 POINT (-81.63306 36.34069)}
\CommentTok{## 1.4 POINT (-81.74107 36.39178)}
\CommentTok{## 1.5 POINT (-81.69828 36.47178)}
\CommentTok{## 1.6  POINT (-81.7028 36.51934)}
\CommentTok{## 1.7    POINT (-81.67 36.58965)}
\CommentTok{## 1.8  POINT (-81.3453 36.57286)}
\CommentTok{## 1.9 POINT (-81.34754 36.53791)}
\end{Highlighting}
\end{Shaded}

\end{frame}

\begin{frame}[fragile,t]{}
\protect\hypertarget{section-1}{}

\scriptoutput

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{plot}\NormalTok{(}\KeywordTok{st_geometry}\NormalTok{(nc), }\DataTypeTok{border=}\StringTok{'grey'}\NormalTok{)}
\KeywordTok{plot}\NormalTok{(}\KeywordTok{st_geometry}\NormalTok{(}\KeywordTok{st_cast}\NormalTok{(nc, }\StringTok{"POINT"}\NormalTok{)), }\DataTypeTok{pch=}\DecValTok{16}\NormalTok{, }\DataTypeTok{cex=}\FloatTok{0.5}\NormalTok{, }\DataTypeTok{add=}\OtherTok{TRUE}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=\textwidth]{Lec16_files/figure-beamer/unnamed-chunk-22-1} \end{center}

\end{frame}

\begin{frame}[fragile,t]{Casting - LINESTRING}
\protect\hypertarget{casting---linestring}{}

\scriptoutput

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{st_cast}\NormalTok{(nc, }\StringTok{"MULTILINESTRING"}\NormalTok{) }\OperatorTok{%>%}\StringTok{ }\KeywordTok{as_tibble}\NormalTok{()}
\CommentTok{## # A tibble: 100 x 8}
\CommentTok{##    NAME  BIR74 SID74 NWBIR74 BIR79 SID79 NWBIR79                  geometry}
\CommentTok{##  * <fct> <dbl> <dbl>   <dbl> <dbl> <dbl>   <dbl>     <MULTILINESTRING [Â°]>}
\CommentTok{##  1 Ashe   1091     1      10  1364     0      19 ((-81.47276 36.23436, -8~}
\CommentTok{##  2 Alle~   487     0      10   542     3      12 ((-81.23989 36.36536, -8~}
\CommentTok{##  3 Surry  3188     5     208  3616     6     260 ((-80.45634 36.24256, -8~}
\CommentTok{##  4 Curr~   508     1     123   830     2     145 ((-76.00897 36.3196, -76~}
\CommentTok{##  5 Nort~  1421     9    1066  1606     3    1197 ((-77.21767 36.24098, -7~}
\CommentTok{##  6 Hert~  1452     7     954  1838     5    1237 ((-76.74506 36.23392, -7~}
\CommentTok{##  7 Camd~   286     0     115   350     2     139 ((-76.00897 36.3196, -75~}
\CommentTok{##  8 Gates   420     0     254   594     2     371 ((-76.56251 36.34057, -7~}
\CommentTok{##  9 Warr~   968     4     748  1190     2     844 ((-78.30876 36.26004, -7~}
\CommentTok{## 10 Stok~  1612     1     160  2038     5     176 ((-80.02567 36.25023, -8~}
\CommentTok{## # ... with 90 more rows}
\end{Highlighting}
\end{Shaded}

\end{frame}

\begin{frame}[fragile,t]{}
\protect\hypertarget{section-2}{}

\scriptoutput

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{st_cast}\NormalTok{(nc, }\StringTok{"MULTILINESTRING"}\NormalTok{) }\OperatorTok{%>%}\StringTok{ }\KeywordTok{st_geometry}\NormalTok{() }\OperatorTok{%>%}\StringTok{ }\KeywordTok{plot}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=\textwidth]{Lec16_files/figure-beamer/unnamed-chunk-24-1} \end{center}

\end{frame}

\begin{frame}[fragile,t]{Grouping Features}
\protect\hypertarget{grouping-features}{}

\scriptoutput

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{nc_state =}\StringTok{ }\KeywordTok{st_union}\NormalTok{(nc)}
\KeywordTok{tbl_df}\NormalTok{(nc_state)}
\CommentTok{## # A tibble: 1 x 1}
\CommentTok{##                                                                    geometry}
\CommentTok{## *                                                        <MULTIPOLYGON [Â°]>}
\CommentTok{## 1 (((-76.54427 34.58783, -76.55515 34.61066, -76.53775 34.61392, -76.48448~}
\KeywordTok{plot}\NormalTok{(nc_state)}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=\textwidth]{Lec16_files/figure-beamer/unnamed-chunk-25-1} \end{center}

\end{frame}

\begin{frame}[fragile,t]{More Grouping}
\protect\hypertarget{more-grouping}{}

\scriptoutput

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{nc_cut =}\StringTok{ }\NormalTok{nc }\OperatorTok{%>%}
\StringTok{  }\KeywordTok{mutate}\NormalTok{(}\DataTypeTok{X =} \KeywordTok{st_centroid}\NormalTok{(nc) }\OperatorTok{%>%}\StringTok{ }\KeywordTok{st_coordinates}\NormalTok{() }\OperatorTok{%>%}\StringTok{ }\NormalTok{.[,}\DecValTok{1}\NormalTok{]) }\OperatorTok{%>%}
\StringTok{  }\KeywordTok{mutate}\NormalTok{(}\DataTypeTok{region =} \KeywordTok{cut}\NormalTok{(X, }\DataTypeTok{breaks =} \DecValTok{5}\NormalTok{))}

\KeywordTok{tbl_df}\NormalTok{(nc_cut)}
\CommentTok{## # A tibble: 100 x 10}
\CommentTok{##    NAME  BIR74 SID74 NWBIR74 BIR79 SID79 NWBIR79     X region}
\CommentTok{##    <fct> <dbl> <dbl>   <dbl> <dbl> <dbl>   <dbl> <dbl> <fct> }
\CommentTok{##  1 Ashe   1091     1      10  1364     0      19 -81.5 (-82.~}
\CommentTok{##  2 Alle~   487     0      10   542     3      12 -81.1 (-82.~}
\CommentTok{##  3 Surry  3188     5     208  3616     6     260 -80.7 (-80.~}
\CommentTok{##  4 Curr~   508     1     123   830     2     145 -76.0 (-77.~}
\CommentTok{##  5 Nort~  1421     9    1066  1606     3    1197 -77.4 (-77.~}
\CommentTok{##  6 Hert~  1452     7     954  1838     5    1237 -77.0 (-77.~}
\CommentTok{##  7 Camd~   286     0     115   350     2     139 -76.2 (-77.~}
\CommentTok{##  8 Gates   420     0     254   594     2     371 -76.7 (-77.~}
\CommentTok{##  9 Warr~   968     4     748  1190     2     844 -78.1 (-79.~}
\CommentTok{## 10 Stok~  1612     1     160  2038     5     176 -80.2 (-80.~}
\CommentTok{## # ... with 90 more rows, and 1 more variable: geometry <MULTIPOLYGON [Â°]>}
\end{Highlighting}
\end{Shaded}

\end{frame}

\begin{frame}[fragile,t]{}
\protect\hypertarget{section-3}{}

\scriptoutput

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{ggplot}\NormalTok{(nc_cut) }\OperatorTok{+}
\StringTok{  }\KeywordTok{geom_sf}\NormalTok{(}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{fill=}\NormalTok{region))}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=\textwidth]{Lec16_files/figure-beamer/unnamed-chunk-27-1} \end{center}

\end{frame}

\begin{frame}[fragile,t]{dplyr and sf}
\protect\hypertarget{dplyr-and-sf}{}

\scriptoutput

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{nc_cut }\OperatorTok{%>%}\StringTok{ }
\StringTok{  }\KeywordTok{group_by}\NormalTok{(region) }\OperatorTok{%>%}\StringTok{ }
\StringTok{  }\KeywordTok{summarize}\NormalTok{() }\OperatorTok{%>%}\StringTok{ }
\StringTok{  }\KeywordTok{ggplot}\NormalTok{() }\OperatorTok{+}\StringTok{ }
\StringTok{    }\KeywordTok{geom_sf}\NormalTok{(}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{fill=}\NormalTok{region))}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=\textwidth]{Lec16_files/figure-beamer/unnamed-chunk-28-1} \end{center}

\end{frame}

\begin{frame}[fragile,t]{Affine Transfomations}
\protect\hypertarget{affine-transfomations}{}

\scriptoutput

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{rotate =}\StringTok{ }\ControlFlowTok{function}\NormalTok{(a) }\KeywordTok{matrix}\NormalTok{(}\KeywordTok{c}\NormalTok{(}\KeywordTok{cos}\NormalTok{(a), }\KeywordTok{sin}\NormalTok{(a), }\OperatorTok{-}\KeywordTok{sin}\NormalTok{(a), }\KeywordTok{cos}\NormalTok{(a)), }\DecValTok{2}\NormalTok{, }\DecValTok{2}\NormalTok{)}

\NormalTok{ctrd =}\StringTok{ }\KeywordTok{st_centroid}\NormalTok{(nc_state)}
\NormalTok{state_rotate =}\StringTok{ }\NormalTok{lwgeom}\OperatorTok{::}\KeywordTok{st_make_valid}\NormalTok{( (nc_state) }\OperatorTok{*}\StringTok{ }\KeywordTok{rotate}\NormalTok{(}\OperatorTok{-}\NormalTok{pi}\OperatorTok{/}\DecValTok{4}\NormalTok{) )}
\KeywordTok{plot}\NormalTok{(state_rotate, }\DataTypeTok{axes=}\OtherTok{TRUE}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=\textwidth]{Lec16_files/figure-beamer/unnamed-chunk-29-1} \end{center}

\end{frame}

\begin{frame}[fragile]{Scaling Size}
\protect\hypertarget{scaling-size}{}

\scriptoutput

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{ctrd =}\StringTok{ }\KeywordTok{st_centroid}\NormalTok{(}\KeywordTok{st_geometry}\NormalTok{(nc))}
\NormalTok{area =}\StringTok{ }\KeywordTok{st_area}\NormalTok{(nc) }\OperatorTok{%>%}\StringTok{ }\KeywordTok{strip_attrs}\NormalTok{()}

\NormalTok{nc_rot =}\StringTok{ }\NormalTok{nc}
\KeywordTok{st_geometry}\NormalTok{(nc_rot) =}\StringTok{ }\NormalTok{(}\KeywordTok{st_geometry}\NormalTok{(nc) }\OperatorTok{-}\StringTok{ }\NormalTok{ctrd) }\OperatorTok{*}\StringTok{ }\FloatTok{0.75} \OperatorTok{+}\StringTok{ }\NormalTok{ctrd}

\KeywordTok{plot}\NormalTok{(nc_rot[,}\StringTok{"SID79"}\NormalTok{])}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=\textwidth]{Lec16_files/figure-beamer/unnamed-chunk-30-1} \end{center}

\end{frame}

\hypertarget{highway-example}{%
\section{Highway Example}\label{highway-example}}

\begin{frame}[fragile,t]{Highways}
\protect\hypertarget{highways}{}

\scriptoutput

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{hwy =}\StringTok{ }\KeywordTok{st_read}\NormalTok{(}\StringTok{"https://www2.stat.duke.edu/~cr173/Sta444_Fa18/slides/data/us_interstates.gpkg"}\NormalTok{, }
              \DataTypeTok{quiet=}\OtherTok{TRUE}\NormalTok{, }\DataTypeTok{stringsAsFactors=}\OtherTok{FALSE}\NormalTok{) }\OperatorTok{%>%}\StringTok{ }\KeywordTok{st_transform}\NormalTok{(}\KeywordTok{st_crs}\NormalTok{(nc))}
\KeywordTok{ggplot}\NormalTok{() }\OperatorTok{+}
\StringTok{  }\KeywordTok{geom_sf}\NormalTok{(}\DataTypeTok{data=}\NormalTok{nc) }\OperatorTok{+}
\StringTok{  }\KeywordTok{geom_sf}\NormalTok{(}\DataTypeTok{data=}\NormalTok{hwy, }\DataTypeTok{col=}\StringTok{'red'}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=\textwidth,height=0.5\textheight]{Lec16_files/figure-beamer/unnamed-chunk-31-1} \end{center}

\end{frame}

\begin{frame}[fragile,t]{NC Interstate Highways}
\protect\hypertarget{nc-interstate-highways}{}

\scriptoutput

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{hwy_nc =}\StringTok{ }\KeywordTok{st_intersection}\NormalTok{(hwy, nc)}
\CommentTok{## although coordinates are longitude/latitude, st_intersection assumes that they are planar}

\KeywordTok{ggplot}\NormalTok{() }\OperatorTok{+}\StringTok{ }
\StringTok{  }\KeywordTok{geom_sf}\NormalTok{(}\DataTypeTok{data=}\NormalTok{nc) }\OperatorTok{+}
\StringTok{  }\KeywordTok{geom_sf}\NormalTok{(}\DataTypeTok{data=}\NormalTok{hwy_nc, }\DataTypeTok{col=}\StringTok{'red'}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=\textwidth]{Lec16_files/figure-beamer/unnamed-chunk-32-1} \end{center}

\end{frame}

\begin{frame}[fragile,t]{Counties near the interstate (Projection)}
\protect\hypertarget{counties-near-the-interstate-projection}{}

\scriptoutput

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{nc_utm  =}\StringTok{ }\KeywordTok{st_transform}\NormalTok{(nc, }\StringTok{"+proj=utm +zone=17 +datum=NAD83 +units=m +no_defs"}\NormalTok{)}

\KeywordTok{ggplot}\NormalTok{() }\OperatorTok{+}\StringTok{ }
\StringTok{  }\KeywordTok{geom_sf}\NormalTok{(}\DataTypeTok{data=}\NormalTok{nc_utm) }\OperatorTok{+}
\StringTok{  }\KeywordTok{geom_sf}\NormalTok{(}\DataTypeTok{data=}\NormalTok{hwy_nc, }\DataTypeTok{col=}\StringTok{'red'}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=\textwidth]{Lec16_files/figure-beamer/unnamed-chunk-33-1} \end{center}

\end{frame}

\begin{frame}[fragile,t]{Counties near the interstate (Buffering)}
\protect\hypertarget{counties-near-the-interstate-buffering}{}

\scriptoutput

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{hwy_nc_buffer =}\StringTok{ }\NormalTok{hwy_nc }\OperatorTok{%>%}
\StringTok{  }\KeywordTok{st_transform}\NormalTok{(}\StringTok{"+proj=utm +zone=17 +datum=NAD83 +units=m +no_defs"}\NormalTok{) }\OperatorTok{%>%}
\StringTok{  }\KeywordTok{st_buffer}\NormalTok{(}\DecValTok{10000}\NormalTok{)}

\KeywordTok{ggplot}\NormalTok{() }\OperatorTok{+}\StringTok{ }
\StringTok{  }\KeywordTok{geom_sf}\NormalTok{(}\DataTypeTok{data=}\NormalTok{nc_utm) }\OperatorTok{+}
\StringTok{  }\KeywordTok{geom_sf}\NormalTok{(}\DataTypeTok{data=}\NormalTok{hwy_nc, }\DataTypeTok{color=}\StringTok{'red'}\NormalTok{) }\OperatorTok{+}
\StringTok{  }\KeywordTok{geom_sf}\NormalTok{(}\DataTypeTok{data=}\NormalTok{hwy_nc_buffer, }\DataTypeTok{fill=}\StringTok{'red'}\NormalTok{, }\DataTypeTok{alpha=}\FloatTok{0.3}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=\textwidth]{Lec16_files/figure-beamer/unnamed-chunk-34-1} \end{center}

\end{frame}

\begin{frame}[fragile,t]{Counties near the interstate (Buffering +
Union)}
\protect\hypertarget{counties-near-the-interstate-buffering-union}{}

\scriptoutput

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{hwy_nc_buffer =}\StringTok{ }\NormalTok{hwy_nc }\OperatorTok{%>%}
\StringTok{  }\KeywordTok{st_transform}\NormalTok{(}\StringTok{"+proj=utm +zone=17 +datum=NAD83 +units=m +no_defs"}\NormalTok{) }\OperatorTok{%>%}
\StringTok{  }\KeywordTok{st_buffer}\NormalTok{(}\DecValTok{10000}\NormalTok{) }\OperatorTok{%>%}
\StringTok{  }\KeywordTok{st_union}\NormalTok{() }\OperatorTok{%>%}
\StringTok{  }\KeywordTok{st_sf}\NormalTok{()}
  
\KeywordTok{ggplot}\NormalTok{() }\OperatorTok{+}\StringTok{ }
\StringTok{  }\KeywordTok{geom_sf}\NormalTok{(}\DataTypeTok{data=}\NormalTok{nc_utm) }\OperatorTok{+}
\StringTok{  }\KeywordTok{geom_sf}\NormalTok{(}\DataTypeTok{data=}\NormalTok{hwy_nc, }\DataTypeTok{color=}\StringTok{'red'}\NormalTok{) }\OperatorTok{+}
\StringTok{  }\KeywordTok{geom_sf}\NormalTok{(}\DataTypeTok{data=}\NormalTok{hwy_nc_buffer, }\DataTypeTok{fill=}\StringTok{'red'}\NormalTok{, }\DataTypeTok{alpha=}\FloatTok{0.3}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=\textwidth]{Lec16_files/figure-beamer/unnamed-chunk-35-1} \end{center}

\end{frame}

\begin{frame}[t]{Example}
\protect\hypertarget{example}{}

How many counties in North Carolina are within 5, 10, 20, or 50 km of an
interstate highway?

\end{frame}

\hypertarget{gerrymandering-example}{%
\section{Gerrymandering Example}\label{gerrymandering-example}}

\begin{frame}[fragile]{NC House Districts - 112th Congress}
\protect\hypertarget{nc-house-districts---112th-congress}{}

\footnoteoutput

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{nc_house =}\StringTok{ }\KeywordTok{st_read}\NormalTok{(}
  \StringTok{"https://www2.stat.duke.edu/~cr173/Sta444_Fa18/slides/data/nc_districts112.gpkg"}\NormalTok{, }
  \DataTypeTok{stringsAsFactors =} \OtherTok{FALSE}\NormalTok{, }\DataTypeTok{quiet =} \OtherTok{TRUE}\NormalTok{) }\OperatorTok{%>%}
\StringTok{  }\KeywordTok{select}\NormalTok{(ID, DISTRICT)}

\KeywordTok{tbl_df}\NormalTok{(nc_house)}
\CommentTok{## # A tibble: 13 x 3}
\CommentTok{##    ID         DISTRICT                                                geom}
\CommentTok{##    <chr>      <chr>                                     <MULTIPOLYGON [Â°]>}
\CommentTok{##  1 037108112~ 1        (((-77.32845 35.35031, -77.35398 35.32799, -77.336~}
\CommentTok{##  2 037108112~ 2        (((-78.89928 35.12619, -78.89763 35.12859, -78.892~}
\CommentTok{##  3 037108112~ 3        (((-75.68266 35.23291, -75.68113 35.23237, -75.682~}
\CommentTok{##  4 037108112~ 4        (((-78.77926 35.78568, -78.77947 35.77568, -78.794~}
\CommentTok{##  5 037108112~ 5        (((-79.8968 36.38075, -79.89213 36.37108, -79.8928~}
\CommentTok{##  6 037108112~ 6        (((-80.4201 35.68953, -80.41483 35.68918, -80.4111~}
\CommentTok{##  7 037108112~ 7        (((-77.59169 34.40907, -77.58699 34.40611, -77.585~}
\CommentTok{##  8 037108112~ 8        (((-78.93373 34.95909, -78.94074 34.95789, -78.943~}
\CommentTok{##  9 037108112~ 9        (((-80.93058 35.18181, -80.9244 35.16754, -80.9210~}
\CommentTok{## 10 037108112~ 10       (((-81.04032 35.40447, -81.30021 35.41461, -81.287~}
\CommentTok{## 11 037108112~ 11       (((-84.00768 35.37262, -84.00831 35.37888, -84.011~}
\CommentTok{## 12 037108112~ 12       (((-80.4996 35.6493, -80.51926 35.63314, -80.52016~}
\CommentTok{## 13 037108112~ 13       (((-79.90775 36.3818, -79.90694 36.38382, -79.9016~}
\end{Highlighting}
\end{Shaded}

\end{frame}

\begin{frame}[fragile]{}
\protect\hypertarget{section-4}{}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{nc_house =}\StringTok{ }\NormalTok{nc_house }\OperatorTok{%>%}
\StringTok{  }\KeywordTok{st_transform}\NormalTok{(}\StringTok{"+proj=utm +zone=17 +datum=NAD83 +units=km +no_defs"}\NormalTok{)}
\KeywordTok{plot}\NormalTok{(nc_house[,}\StringTok{"DISTRICT"}\NormalTok{], }\DataTypeTok{axes=}\OtherTok{TRUE}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=\textwidth]{Lec16_files/figure-beamer/unnamed-chunk-37-1} \end{center}

\end{frame}

\begin{frame}[fragile,t]{Measuring Compactness - Reock Score}
\protect\hypertarget{measuring-compactness---reock-score}{}

The Reock score the a measure of compactness that is calculated as the
the ratio area of a shape to the area of its minimum bounding circle.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{circs =}\StringTok{ }\NormalTok{nc_house }\OperatorTok{%>%}\StringTok{ }\KeywordTok{st_geometry}\NormalTok{() }\OperatorTok{%>%}\StringTok{ }\NormalTok{lwgeom}\OperatorTok{::}\KeywordTok{st_minimum_bounding_circle}\NormalTok{()}

\NormalTok{sub =}\StringTok{ }\NormalTok{nc_house}\OperatorTok{$}\NormalTok{DISTRICT }\OperatorTok{==}\StringTok{ }\DecValTok{1}
\KeywordTok{plot}\NormalTok{(circs[sub])}
\KeywordTok{plot}\NormalTok{(nc_house[sub,}\StringTok{"DISTRICT"}\NormalTok{], }\DataTypeTok{add=}\OtherTok{TRUE}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=0.4\textwidth]{Lec16_files/figure-beamer/unnamed-chunk-38-1} \end{center}

\end{frame}

\begin{frame}[fragile]{}
\protect\hypertarget{section-5}{}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{plot}\NormalTok{(nc_house[,}\StringTok{"DISTRICT"}\NormalTok{])}
\KeywordTok{plot}\NormalTok{(circs,}\DataTypeTok{add=}\OtherTok{TRUE}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=\textwidth]{Lec16_files/figure-beamer/unnamed-chunk-39-1} \end{center}

\end{frame}

\begin{frame}[fragile]{Calculating Reock}
\protect\hypertarget{calculating-reock}{}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{nc_house =}\StringTok{ }\NormalTok{nc_house }\OperatorTok{%>%}
\StringTok{  }\KeywordTok{mutate}\NormalTok{(}\DataTypeTok{reock =} \KeywordTok{st_area}\NormalTok{(nc_house) }\OperatorTok{/}\StringTok{ }\KeywordTok{st_area}\NormalTok{(circs))}
\KeywordTok{plot}\NormalTok{(nc_house[,}\StringTok{"reock"}\NormalTok{])}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=0.8\textwidth]{Lec16_files/figure-beamer/unnamed-chunk-40-1} \end{center}

\end{frame}

\begin{frame}[fragile]{}
\protect\hypertarget{section-6}{}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{tbl_df}\NormalTok{(nc_house) }\OperatorTok{%>%}\StringTok{ }
\StringTok{  }\KeywordTok{arrange}\NormalTok{(reock) }\OperatorTok{%>%}
\StringTok{  }\KeywordTok{print}\NormalTok{(}\DataTypeTok{n=}\DecValTok{13}\NormalTok{)}
\CommentTok{## # A tibble: 13 x 4}
\CommentTok{##    ID       DISTRICT reock                                            geom}
\CommentTok{##    <chr>    <chr>    <S3: uni>                         <MULTIPOLYGON [km]>}
\CommentTok{##  1 0371081~ 12       0.115548~ (((545.2989 3945.167, 543.5279 3943.366, 5~}
\CommentTok{##  2 0371081~ 13       0.237185~ (((597.9666 4026.851, 598.0375 4027.076, 5~}
\CommentTok{##  3 0371081~ 3        0.266378~ (((984.071 3911.853, 984.2139 3911.8, 984.~}
\CommentTok{##  4 0371081~ 2        0.303422~ (((691.4142 3889.056, 691.5584 3889.327, 6~}
\CommentTok{##  5 0371081~ 9        0.338722~ (((506.3209 3893.208, 506.885 3891.626, 50~}
\CommentTok{##  6 0371081~ 8        0.341645~ (((688.6585 3870.456, 688.021 3870.31, 687~}
\CommentTok{##  7 0371081~ 11       0.343731~ (((226.7524 3918.52, 226.7167 3919.217, 22~}
\CommentTok{##  8 0371081~ 6        0.377542~ (((552.4693 3949.669, 552.9463 3949.632, 5~}
\CommentTok{##  9 0371081~ 1        0.377659~ (((833.6772 3918.082, 831.4469 3915.52, 83~}
\CommentTok{## 10 0371081~ 5        0.398978~ (((598.9506 4026.745, 599.3817 4025.677, 5~}
\CommentTok{## 11 0371081~ 10       0.410830~ (((496.3392 3917.9, 472.7445 3919.064, 473~}
\CommentTok{## 12 0371081~ 4        0.480027~ (((700.7066 3962.453, 700.712 3961.343, 69~}
\CommentTok{## 13 0371081~ 7        0.623895~ (((813.3007 3812.784, 813.7436 3812.471, 8~}
\end{Highlighting}
\end{Shaded}

\end{frame}

\hypertarget{raster-data}{%
\section{Raster Data}\label{raster-data}}

\begin{frame}[fragile,t]{Example data - Meuse}
\protect\hypertarget{example-data---meuse-1}{}

\scriptoutput

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{meuse_rast =}\StringTok{ }\KeywordTok{raster}\NormalTok{(}\KeywordTok{system.file}\NormalTok{(}\StringTok{"external/test.grd"}\NormalTok{, }\DataTypeTok{package=}\StringTok{"raster"}\NormalTok{))}

\NormalTok{meuse_rast}
\CommentTok{## class       : RasterLayer }
\CommentTok{## dimensions  : 115, 80, 9200  (nrow, ncol, ncell)}
\CommentTok{## resolution  : 40, 40  (x, y)}
\CommentTok{## extent      : 178400, 181600, 329400, 334000  (xmin, xmax, ymin, ymax)}
\CommentTok{## coord. ref. : +init=epsg:28992 +towgs84=565.237,50.0087,465.658,-0.406857,0.350733,-1.87035,4.0812 +proj=sterea +lat_0=52.15616055555555 +lon_0=5.38763888888889 +k=0.9999079 +x_0=155000 +y_0=463000 +ellps=bessel +units=m +no_defs }
\CommentTok{## data source : /usr/local/lib/R/3.5/site-library/raster/external/test.grd }
\CommentTok{## names       : test }
\CommentTok{## values      : 128.434, 1805.78  (min, max)}
\end{Highlighting}
\end{Shaded}

\end{frame}

\begin{frame}[fragile,t]{}
\protect\hypertarget{section-7}{}

\scriptoutput

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{plot}\NormalTok{(meuse_rast)}
\KeywordTok{plot}\NormalTok{(meuse_riv, }\DataTypeTok{add=}\OtherTok{TRUE}\NormalTok{, }\DataTypeTok{col=}\KeywordTok{adjustcolor}\NormalTok{(}\StringTok{"lightblue"}\NormalTok{,}\DataTypeTok{alpha.f =} \FloatTok{0.5}\NormalTok{), }\DataTypeTok{border=}\OtherTok{NA}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=\textwidth]{Lec16_files/figure-beamer/unnamed-chunk-43-1} \end{center}

\end{frame}

\begin{frame}[fragile]{raster class}
\protect\hypertarget{raster-class}{}

\scriptoutput

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{str}\NormalTok{(meuse_rast)}
\CommentTok{## Formal class 'RasterLayer' [package "raster"] with 12 slots}
\CommentTok{##   ..@ file    :Formal class '.RasterFile' [package "raster"] with 13 slots}
\CommentTok{##   .. .. ..@ name        : chr "/usr/local/lib/R/3.5/site-library/raster/external/test.grd"}
\CommentTok{##   .. .. ..@ datanotation: chr "FLT4S"}
\CommentTok{##   .. .. ..@ byteorder   : Named chr "little"}
\CommentTok{##   .. .. .. ..- attr(*, "names")= chr "value"}
\CommentTok{##   .. .. ..@ nodatavalue : num -3.4e+38}
\CommentTok{##   .. .. ..@ NAchanged   : logi FALSE}
\CommentTok{##   .. .. ..@ nbands      : int 1}
\CommentTok{##   .. .. ..@ bandorder   : Named chr "BIL"}
\CommentTok{##   .. .. .. ..- attr(*, "names")= chr "value"}
\CommentTok{##   .. .. ..@ offset      : int 0}
\CommentTok{##   .. .. ..@ toptobottom : logi TRUE}
\CommentTok{##   .. .. ..@ blockrows   : int 0}
\CommentTok{##   .. .. ..@ blockcols   : int 0}
\CommentTok{##   .. .. ..@ driver      : chr "raster"}
\CommentTok{##   .. .. ..@ open        : logi FALSE}
\CommentTok{##   ..@ data    :Formal class '.SingleLayerData' [package "raster"] with 13 slots}
\CommentTok{##   .. .. ..@ values    : logi(0) }
\CommentTok{##   .. .. ..@ offset    : num 0}
\CommentTok{##   .. .. ..@ gain      : num 1}
\CommentTok{##   .. .. ..@ inmemory  : logi FALSE}
\CommentTok{##   .. .. ..@ fromdisk  : logi TRUE}
\CommentTok{##   .. .. ..@ isfactor  : logi FALSE}
\CommentTok{##   .. .. ..@ attributes: list()}
\CommentTok{##   .. .. ..@ haveminmax: logi TRUE}
\CommentTok{##   .. .. ..@ min       : num 128}
\CommentTok{##   .. .. ..@ max       : num 1806}
\CommentTok{##   .. .. ..@ band      : int 1}
\CommentTok{##   .. .. ..@ unit      : chr ""}
\CommentTok{##   .. .. ..@ names     : chr "test"}
\CommentTok{##   ..@ legend  :Formal class '.RasterLegend' [package "raster"] with 5 slots}
\CommentTok{##   .. .. ..@ type      : chr(0) }
\CommentTok{##   .. .. ..@ values    : logi(0) }
\CommentTok{##   .. .. ..@ color     : logi(0) }
\CommentTok{##   .. .. ..@ names     : logi(0) }
\CommentTok{##   .. .. ..@ colortable: logi(0) }
\CommentTok{##   ..@ title   : chr(0) }
\CommentTok{##   ..@ extent  :Formal class 'Extent' [package "raster"] with 4 slots}
\CommentTok{##   .. .. ..@ xmin: num 178400}
\CommentTok{##   .. .. ..@ xmax: num 181600}
\CommentTok{##   .. .. ..@ ymin: num 329400}
\CommentTok{##   .. .. ..@ ymax: num 334000}
\CommentTok{##   ..@ rotated : logi FALSE}
\CommentTok{##   ..@ rotation:Formal class '.Rotation' [package "raster"] with 2 slots}
\CommentTok{##   .. .. ..@ geotrans: num(0) }
\CommentTok{##   .. .. ..@ transfun:function ()  }
\CommentTok{##   ..@ ncols   : int 80}
\CommentTok{##   ..@ nrows   : int 115}
\CommentTok{##   ..@ crs     :Formal class 'CRS' [package "sp"] with 1 slot}
\CommentTok{##   .. .. ..@ projargs: chr "+init=epsg:28992 +towgs84=565.237,50.0087,465.658,-0.406857,0.350733,-1.87035,4.0812 +proj=sterea +lat_0=52.156"| __truncated__}
\CommentTok{##   ..@ history : list()}
\CommentTok{##   ..@ z       : list()}
\end{Highlighting}
\end{Shaded}

\end{frame}

\begin{frame}[fragile,t]{raster features}
\protect\hypertarget{raster-features}{}

\scriptoutput

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{extent}\NormalTok{(meuse_rast)}
\CommentTok{## class       : Extent }
\CommentTok{## xmin        : 178400 }
\CommentTok{## xmax        : 181600 }
\CommentTok{## ymin        : 329400 }
\CommentTok{## ymax        : 334000}

\KeywordTok{dim}\NormalTok{(meuse_rast)}
\CommentTok{## [1] 115  80   1}

\KeywordTok{res}\NormalTok{(meuse_rast)}
\CommentTok{## [1] 40 40}

\KeywordTok{projection}\NormalTok{(meuse_rast)}
\CommentTok{## [1] "+init=epsg:28992 +towgs84=565.237,50.0087,465.658,-0.406857,0.350733,-1.87035,4.0812 +proj=sterea +lat_0=52.15616055555555 +lon_0=5.38763888888889 +k=0.9999079 +x_0=155000 +y_0=463000 +ellps=bessel +units=m +no_defs"}

\NormalTok{meuse_rast[}\DecValTok{20}\NormalTok{,]}
\CommentTok{##  [1]      NA      NA      NA      NA      NA      NA      NA      NA}
\CommentTok{##  [9]      NA      NA      NA      NA      NA      NA      NA      NA}
\CommentTok{## [17]      NA      NA      NA      NA      NA      NA      NA      NA}
\CommentTok{## [25]      NA      NA      NA      NA      NA      NA      NA      NA}
\CommentTok{## [33]      NA      NA      NA      NA      NA      NA      NA      NA}
\CommentTok{## [41]      NA      NA      NA      NA      NA      NA      NA      NA}
\CommentTok{## [49]      NA      NA      NA      NA      NA      NA      NA      NA}
\CommentTok{## [57]      NA      NA      NA 749.536 895.292 791.145 607.186 511.044}
\CommentTok{## [65] 468.404 399.325 350.362 306.180 300.483 310.082 283.940 285.771}
\CommentTok{## [73] 304.709 309.690 301.799 308.753 328.357 345.611      NA      NA}
\end{Highlighting}
\end{Shaded}

\end{frame}

\begin{frame}[fragile,t]{Rasters and Projections}
\protect\hypertarget{rasters-and-projections}{}

\scriptoutput

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{library}\NormalTok{(rgdal)}
\NormalTok{meuse_rast_ll =}\StringTok{ }\KeywordTok{projectRaster}\NormalTok{(meuse_rast, }\DataTypeTok{crs=}\StringTok{"+proj=longlat +datum=NAD27 +no_defs"}\NormalTok{)}

\KeywordTok{par}\NormalTok{(}\DataTypeTok{mfrow=}\KeywordTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{,}\DecValTok{2}\NormalTok{))}
\KeywordTok{plot}\NormalTok{(meuse_rast)}
\KeywordTok{plot}\NormalTok{(meuse_rast_ll)}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=\textwidth]{Lec16_files/figure-beamer/unnamed-chunk-46-1} \end{center}

\end{frame}

\begin{frame}[fragile,t]{}
\protect\hypertarget{section-8}{}

\scriptsize

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{meuse_rast}
\CommentTok{## class       : RasterLayer }
\CommentTok{## dimensions  : 115, 80, 9200  (nrow, ncol, ncell)}
\CommentTok{## resolution  : 40, 40  (x, y)}
\CommentTok{## extent      : 178400, 181600, 329400, 334000  (xmin, xmax, ymin, ymax)}
\CommentTok{## coord. ref. : +init=epsg:28992 +towgs84=565.237,50.0087,465.658,-0.406857,0.350733,-1.87035,4.0812 +proj=sterea +lat_0=52.15616055555555 +lon_0=5.38763888888889 +k=0.9999079 +x_0=155000 +y_0=463000 +ellps=bessel +units=m +no_defs }
\CommentTok{## data source : /usr/local/lib/R/3.5/site-library/raster/external/test.grd }
\CommentTok{## names       : test }
\CommentTok{## values      : 128.434, 1805.78  (min, max)}

\NormalTok{meuse_rast_ll}
\CommentTok{## class       : RasterLayer }
\CommentTok{## dimensions  : 131, 91, 11921  (nrow, ncol, ncell)}
\CommentTok{## resolution  : 0.000569, 0.00036  (x, y)}
\CommentTok{## extent      : 5.717362, 5.769141, 50.95089, 50.99805  (xmin, xmax, ymin, ymax)}
\CommentTok{## coord. ref. : +proj=longlat +datum=NAD27 +no_defs +ellps=clrk66 +nadgrids=@conus,@alaska,@ntv2_0.gsb,@ntv1_can.dat }
\CommentTok{## data source : in memory}
\CommentTok{## names       : test }
\CommentTok{## values      : 135.647, 1693.578  (min, max)}
\end{Highlighting}
\end{Shaded}

\end{frame}

\begin{frame}[fragile,t]{Simple Features \(\longleftrightarrow\)
Rasters}
\protect\hypertarget{simple-features-longleftrightarrow-rasters}{}

\scriptoutput

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{meuse_riv_rast =}\StringTok{ }\KeywordTok{rasterize}\NormalTok{(meuse_riv, meuse_rast)}
\CommentTok{## Error in (function (classes, fdef, mtable) : unable to find an inherited method for function 'rasterize' for signature '"sfc_POLYGON", "RasterLayer"'}

\NormalTok{meuse_riv_rast =}\StringTok{ }\KeywordTok{rasterize}\NormalTok{(}\KeywordTok{as}\NormalTok{(meuse_riv, }\StringTok{"Spatial"}\NormalTok{), meuse_rast)}
\KeywordTok{plot}\NormalTok{(meuse_riv_rast)}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=\textwidth]{Lec16_files/figure-beamer/unnamed-chunk-48-1} \end{center}

\end{frame}

\begin{frame}[fragile,t]{Rasters and Spatial Models}
\protect\hypertarget{rasters-and-spatial-models}{}

\scriptoutput

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{head}\NormalTok{(meuse)}
\CommentTok{## Simple feature collection with 6 features and 12 fields}
\CommentTok{## geometry type:  POINT}
\CommentTok{## dimension:      XY}
\CommentTok{## bbox:           xmin: 181025 ymin: 333260 xmax: 181390 ymax: 333611}
\CommentTok{## epsg (SRID):    28992}
\CommentTok{## proj4string:    +proj=sterea +lat_0=52.15616055555555 +lon_0=5.38763888888889 +k=0.9999079 +x_0=155000 +y_0=463000 +ellps=bessel +towgs84=565.2369,50.0087,465.658,-0.406857,0.350733,-1.87035,4.0812 +units=m +no_defs}
\CommentTok{##   cadmium copper lead zinc  elev       dist   om ffreq soil lime landuse}
\CommentTok{## 1    11.7     85  299 1022 7.909 0.00135803 13.6     1    1    1      Ah}
\CommentTok{## 2     8.6     81  277 1141 6.983 0.01222430 14.0     1    1    1      Ah}
\CommentTok{## 3     6.5     68  199  640 7.800 0.10302900 13.0     1    1    1      Ah}
\CommentTok{## 4     2.6     81  116  257 7.655 0.19009400  8.0     1    2    0      Ga}
\CommentTok{## 5     2.8     48  117  269 7.480 0.27709000  8.7     1    2    0      Ah}
\CommentTok{## 6     3.0     61  137  281 7.791 0.36406700  7.8     1    2    0      Ga}
\CommentTok{##   dist.m              geometry}
\CommentTok{## 1     50 POINT (181072 333611)}
\CommentTok{## 2     30 POINT (181025 333558)}
\CommentTok{## 3    150 POINT (181165 333537)}
\CommentTok{## 4    270 POINT (181298 333484)}
\CommentTok{## 5    380 POINT (181307 333330)}
\CommentTok{## 6    470 POINT (181390 333260)}

\KeywordTok{head}\NormalTok{(}\KeywordTok{st_coordinates}\NormalTok{(meuse))}
\CommentTok{##        X      Y}
\CommentTok{## 1 181072 333611}
\CommentTok{## 2 181025 333558}
\CommentTok{## 3 181165 333537}
\CommentTok{## 4 181298 333484}
\CommentTok{## 5 181307 333330}
\CommentTok{## 6 181390 333260}
\end{Highlighting}
\end{Shaded}

\end{frame}

\begin{frame}[fragile,t]{}
\protect\hypertarget{section-9}{}

\scriptoutput

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{library}\NormalTok{(fields)}

\NormalTok{tps =}\StringTok{ }\KeywordTok{Tps}\NormalTok{(}\DataTypeTok{x =} \KeywordTok{st_coordinates}\NormalTok{(meuse), }\DataTypeTok{Y=}\NormalTok{meuse}\OperatorTok{$}\NormalTok{elev)}
\NormalTok{pred_grid =}\StringTok{ }\KeywordTok{xyFromCell}\NormalTok{(meuse_rast, }\KeywordTok{seq_along}\NormalTok{(meuse_rast))}

\NormalTok{meuse_elev_pred =}\StringTok{ }\NormalTok{meuse_rast}
\NormalTok{meuse_elev_pred[] =}\StringTok{ }\KeywordTok{predict}\NormalTok{(tps, pred_grid)}

\KeywordTok{plot}\NormalTok{(meuse_elev_pred)}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=\textwidth]{Lec16_files/figure-beamer/unnamed-chunk-50-1} \end{center}

\end{frame}

\begin{frame}[fragile]{ggplot and rasters}
\protect\hypertarget{ggplot-and-rasters}{}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{p =}\StringTok{ }\KeywordTok{rasterToPolygons}\NormalTok{(meuse_elev_pred) }\OperatorTok{%>%}\StringTok{ }\KeywordTok{st_as_sf}\NormalTok{()}

\NormalTok{(}\KeywordTok{ggplot}\NormalTok{() }\OperatorTok{+}\StringTok{ }\KeywordTok{geom_sf}\NormalTok{(}\DataTypeTok{data=}\NormalTok{meuse, }\KeywordTok{aes}\NormalTok{(}\DataTypeTok{color=}\NormalTok{elev), }\DataTypeTok{size=}\DecValTok{1}\NormalTok{)) }\OperatorTok{+}\StringTok{ }
\NormalTok{(}\KeywordTok{ggplot}\NormalTok{() }\OperatorTok{+}\StringTok{ }\KeywordTok{geom_sf}\NormalTok{(}\DataTypeTok{data=}\NormalTok{p, }\KeywordTok{aes}\NormalTok{(}\DataTypeTok{fill=}\NormalTok{test), }\DataTypeTok{color=}\OtherTok{NA}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=\textwidth]{Lec16_files/figure-beamer/unnamed-chunk-51-1} \end{center}

\end{frame}

\end{document}
